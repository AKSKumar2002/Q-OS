{"version":3,"file":"command-nBL1aO7T.js","sources":["../../src/core/command.ts"],"sourcesContent":["import { App, SettingsManager, SystemManager, VirtualFolder, VirtualRoot } from \"@prozilla-os/core\";\nimport { Stream } from \"./stream\";\nimport { Dispatch, SetStateAction } from \"react\";\nimport { HistoryEntry } from \"../components/Terminal\";\n\ntype Option = {\n\tlong: string,\n\tshort: string,\n\tisInput: boolean\n};\n\nexport type CommandResponse = string | { blank: boolean } | void | Stream;\nexport type ExecuteParams = {\n\tpromptOutput?: (text: string) => void,\n\tpushHistory?: (entry: HistoryEntry) => void,\n\tvirtualRoot?: VirtualRoot,\n\tcurrentDirectory: VirtualFolder,\n\tsetCurrentDirectory?: Dispatch<SetStateAction<VirtualFolder>>,\n\tusername?: string,\n\thostname?: string,\n\trawInputValue?: string,\n\toptions?: string[],\n\texit?: () => void,\n\tinputs?: Record<string, string>,\n\ttimestamp: number,\n\tsettingsManager: SettingsManager,\n\tsystemManager: SystemManager,\n\tapp: App,\n};\n\ntype Execute = (args?: string[], params?: ExecuteParams) => CommandResponse | Promise<CommandResponse>;\n\ntype Manual = {\n\tpurpose?: string,\n\tusage?: string,\n\tdescription?: string,\n\toptions?: object\n};\n\nexport class Command {\n\tname: string = \"command\";\n\toptions: Option[] = [];\n\tmanual: Manual | undefined;\n\trequireArgs: boolean | undefined;\n\trequireOptions: boolean | undefined;\n\n\texecute: Execute = () => {};\n\n\tsetName(name: string): Command {\n\t\tthis.name = name;\n\n\t\tif (!this.manual?.usage) {\n\t\t\tif (!this.manual)\n\t\t\t\tthis.manual = {};\n\n\t\t\tthis.manual.usage = name;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tsetExecute(execute: Execute): Command {\n\t\tthis.execute = execute;\n\t\treturn this;\n\t}\n\n\tsetRequireArgs(value: boolean): Command {\n\t\tthis.requireArgs = value;\n\t\treturn this;\n\t}\n\n\tsetRequireOptions(value: boolean): Command {\n\t\tthis.requireOptions = value;\n\t\treturn this;\n\t}\n\n\tsetManual({ purpose, usage, description, options }: Manual): Command {\n\t\tthis.manual = { purpose, usage, description, options };\n\t\treturn this;\n\t}\n\n\taddOption({ short, long, isInput }: Option): Command {\n\t\tthis.options.push({ short, long, isInput });\n\t\treturn this;\n\t}\n\n\tgetOption(key: string): Option | null {\n\t\tlet matchingOption: Option | null = null;\n\n\t\tthis.options.forEach((option) => {\n\t\t\tif (option.short === key || option.long === key)\n\t\t\t\tmatchingOption = option;\n\t\t});\n\n\t\treturn matchingOption;\n\t}\n}"],"names":["Command","__publicField","name","_a","execute","value","purpose","usage","description","options","short","long","isInput","key","matchingOption","option"],"mappings":";;;AAuCO,MAAMA,EAAQ;AAAA,EAAd;AACN,IAAAC,EAAA,cAAe;AACf,IAAAA,EAAA,iBAAoB,CAAA;AACpB,IAAAA,EAAA;AACA,IAAAA,EAAA;AACA,IAAAA,EAAA;AAEA,IAAAA,EAAA,iBAAmB,MAAM;AAAA,IAAA;AAAA;AAAA,EAEzB,QAAQC,GAAuB;AATzB,QAAAC;AAUL,gBAAK,OAAOD,IAEPC,IAAA,KAAK,WAAL,QAAAA,EAAa,UACZ,KAAK,WACT,KAAK,SAAS,KAEf,KAAK,OAAO,QAAQD,IAGd;AAAA,EACR;AAAA,EAEA,WAAWE,GAA2B;AACrC,gBAAK,UAAUA,GACR;AAAA,EACR;AAAA,EAEA,eAAeC,GAAyB;AACvC,gBAAK,cAAcA,GACZ;AAAA,EACR;AAAA,EAEA,kBAAkBA,GAAyB;AAC1C,gBAAK,iBAAiBA,GACf;AAAA,EACR;AAAA,EAEA,UAAU,EAAE,SAAAC,GAAS,OAAAC,GAAO,aAAAC,GAAa,SAAAC,KAA4B;AACpE,gBAAK,SAAS,EAAE,SAAAH,GAAS,OAAAC,GAAO,aAAAC,GAAa,SAAAC,KACtC;AAAA,EACR;AAAA,EAEA,UAAU,EAAE,OAAAC,GAAO,MAAAC,GAAM,SAAAC,KAA4B;AACpD,gBAAK,QAAQ,KAAK,EAAE,OAAAF,GAAO,MAAAC,GAAM,SAAAC,GAAS,GACnC;AAAA,EACR;AAAA,EAEA,UAAUC,GAA4B;AACrC,QAAIC,IAAgC;AAE/B,gBAAA,QAAQ,QAAQ,CAACC,MAAW;AAChC,OAAIA,EAAO,UAAUF,KAAOE,EAAO,SAASF,OAC1BC,IAAAC;AAAA,IAAA,CAClB,GAEMD;AAAA,EACR;AACD;"}