{"version":3,"file":"lolcat-5cidz0aR.js","sources":["../../src/core/commands/lolcat.ts"],"sourcesContent":["import { ANSI } from \"@prozilla-os/shared\";\nimport { removeAnsi } from \"../_utils/terminal.utils\";\nimport { Command, ExecuteParams } from \"../command\";\n\nconst COLUMN_WIDTH = 5;\nconst ROW_OFFSET = 2;\n\nconst RAINBOW = [\n\tANSI.fg.red,\n\tANSI.fg.yellow,\n\tANSI.fg.green,\n\tANSI.fg.cyan,\n\tANSI.fg.blue,\n\tANSI.fg.magenta,\n];\n\nexport const lolcat = new Command()\n\t.setManual({\n\t\tpurpose: \"Display text with a rainbow effect\",\n\t})\n\t.setExecute(function(_args, params) {\n\t\tconst { rawInputValue, timestamp } = params as ExecuteParams;\n\t\tif (rawInputValue == null) return;\n\t\tlet rows = removeAnsi(rawInputValue).split(\"\\n\");\n\t\tconst offset = timestamp / 100;\n\n\t\trows = rows.map((row, index) => {\n\t\t\tconst columns: string[] = [];\n\n\t\t\tconst rowIndex = index + offset;\n\t\t\tconst rowOffset = COLUMN_WIDTH - ((ROW_OFFSET * rowIndex) % COLUMN_WIDTH);\n\t\t\tlet rainbowIndex = Math.floor(rowIndex / (COLUMN_WIDTH / ROW_OFFSET));\n\n\t\t\tconst addColumn = (start: number, end: number) => {\n\t\t\t\tconst column = row.substring(start, end);\n\t\t\t\tconst color = RAINBOW[rainbowIndex++ % RAINBOW.length];\n\t\t\t\tcolumns.push(color + column);\n\t\t\t};\n\n\t\t\tif (rowOffset > 0)\n\t\t\t\taddColumn(0, rowOffset);\n\t\n\t\t\tfor (let i = rowOffset; i < row.length; i += COLUMN_WIDTH + 1) {\n\t\t\t\taddColumn(i, i + COLUMN_WIDTH + 1);\n\t\t\t}\n\n\t\t\tif (row.length === 0)\n\t\t\t\treturn \"\";\n\n\t\t\treturn columns.join(\"\");\n\t\t});\n\n\t\treturn rows.join(\"\\n\");\n\t});"],"names":["COLUMN_WIDTH","ROW_OFFSET","RAINBOW","ANSI","lolcat","Command","_args","params","rawInputValue","timestamp","rows","removeAnsi","offset","row","index","columns","rowIndex","rowOffset","rainbowIndex","addColumn","start","end","column","color","i"],"mappings":";;;AAIA,MAAMA,IAAe,GACfC,IAAa,GAEbC,IAAU;AAAA,EACfC,EAAK,GAAG;AAAA,EACRA,EAAK,GAAG;AAAA,EACRA,EAAK,GAAG;AAAA,EACRA,EAAK,GAAG;AAAA,EACRA,EAAK,GAAG;AAAA,EACRA,EAAK,GAAG;AACT,GAEaC,IAAS,IAAIC,EAAQ,EAChC,UAAU;AAAA,EACV,SAAS;AACV,CAAC,EACA,WAAW,SAASC,GAAOC,GAAQ;AAC7B,QAAA,EAAE,eAAAC,GAAe,WAAAC,EAAc,IAAAF;AACrC,MAAIC,KAAiB,KAAM;AAC3B,MAAIE,IAAOC,EAAWH,CAAa,EAAE,MAAM;AAAA,CAAI;AAC/C,QAAMI,IAASH,IAAY;AAE3B,SAAAC,IAAOA,EAAK,IAAI,CAACG,GAAKC,MAAU;AAC/B,UAAMC,IAAoB,CAAA,GAEpBC,IAAWF,IAAQF,GACnBK,IAAYjB,IAAiBC,IAAae,IAAYhB;AAC5D,QAAIkB,IAAe,KAAK,MAAMF,KAAYhB,IAAeC,EAAW;AAE9D,UAAAkB,IAAY,CAACC,GAAeC,MAAgB;AACjD,YAAMC,IAAST,EAAI,UAAUO,GAAOC,CAAG,GACjCE,IAAQrB,EAAQgB,MAAiBhB,EAAQ,MAAM;AAC7C,MAAAa,EAAA,KAAKQ,IAAQD,CAAM;AAAA,IAAA;AAG5B,IAAIL,IAAY,KACfE,EAAU,GAAGF,CAAS;AAEvB,aAASO,IAAIP,GAAWO,IAAIX,EAAI,QAAQW,KAAKxB,IAAe;AACjD,MAAAmB,EAAAK,GAAGA,IAAIxB,IAAe,CAAC;AAGlC,WAAIa,EAAI,WAAW,IACX,KAEDE,EAAQ,KAAK,EAAE;AAAA,EAAA,CACtB,GAEML,EAAK,KAAK;AAAA,CAAI;AACtB,CAAC;"}